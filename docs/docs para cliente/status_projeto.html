<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Biohelp LRP â€” Status do Projeto</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #ffffff;
            --bg-secondary: #f7f6f3;
            --bg-hover: #efefef;
            --text: #37352f;
            --text-secondary: #6b6b6b;
            --text-light: #9b9a97;
            --border: #e3e2de;
            --green: #0f7b6c;
            --green-bg: #dbeddb;
            --yellow: #dfab01;
            --yellow-bg: #fdecc8;
            --red: #e03e3e;
            --red-bg: #ffe2dd;
            --blue: #0b6e99;
            --blue-bg: #d3e5ef;
            --purple: #6940a5;
            --purple-bg: #e8deee;
            --gray-bg: #ebeced;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            font-size: 16px;
        }
        .page { max-width: 900px; margin: 0 auto; padding: 60px 96px; }
        @media (max-width: 768px) { .page { padding: 40px 24px; } }
        .page-header { margin-bottom: 40px; }
        .page-icon { font-size: 72px; margin-bottom: 12px; }
        h1.page-title { font-size: 40px; font-weight: 700; letter-spacing: -0.02em; margin-bottom: 8px; }
        .page-description { color: var(--text-secondary); font-size: 16px; }
        .status-badge {
            display: inline-flex; align-items: center; gap: 6px;
            background: var(--green-bg); color: var(--green);
            padding: 4px 10px; border-radius: 4px; font-size: 14px; font-weight: 600; margin-left: 8px;
        }
        h1 { font-size: 28px; font-weight: 600; margin: 48px 0 16px; letter-spacing: -0.01em; }
        h2 { font-size: 22px; font-weight: 600; margin: 36px 0 12px; letter-spacing: -0.01em; }
        h3 { font-size: 18px; font-weight: 600; margin: 28px 0 8px; }
        h4 { font-size: 16px; font-weight: 600; margin: 20px 0 8px; }
        p { margin: 8px 0; }
        a { color: var(--blue); text-decoration: none; }
        a:hover { text-decoration: underline; }
        hr { border: none; border-top: 1px solid var(--border); margin: 40px 0; }
        .progress-section { margin: 24px 0; }
        .progress-item { display: flex; align-items: center; gap: 16px; padding: 8px 0; }
        .progress-label { width: 240px; font-size: 14px; }
        .progress-bar { flex: 1; height: 8px; background: var(--bg-secondary); border-radius: 4px; overflow: hidden; }
        .progress-fill { height: 100%; background: var(--green); border-radius: 4px; transition: width 0.3s; }
        .progress-value { width: 80px; text-align: right; font-size: 14px; color: var(--text-secondary); }
        .callout { display: flex; gap: 12px; padding: 16px; border-radius: 6px; margin: 16px 0; }
        .callout-icon { font-size: 20px; flex-shrink: 0; }
        .callout-content { flex: 1; }
        .callout.yellow { background: var(--yellow-bg); }
        .callout.green { background: var(--green-bg); }
        .callout.blue { background: var(--blue-bg); }
        .callout.red { background: var(--red-bg); }
        .callout.gray { background: var(--gray-bg); }
        table { width: 100%; border-collapse: collapse; margin: 16px 0; font-size: 14px; }
        th { text-align: left; padding: 10px 12px; background: var(--bg-secondary); font-weight: 500; color: var(--text-secondary); border: 1px solid var(--border); }
        td { padding: 10px 12px; border: 1px solid var(--border); vertical-align: top; }
        tr:hover td { background: var(--bg-hover); }
        .tag { display: inline-block; padding: 2px 8px; border-radius: 4px; font-size: 12px; font-weight: 500; }
        .tag.green { background: var(--green-bg); color: var(--green); }
        .tag.yellow { background: var(--yellow-bg); color: var(--yellow); }
        .tag.red { background: var(--red-bg); color: var(--red); }
        .tag.blue { background: var(--blue-bg); color: var(--blue); }
        .tag.gray { background: var(--gray-bg); color: var(--text-secondary); }
        code { font-family: 'IBM Plex Mono', monospace; background: var(--bg-secondary); padding: 2px 6px; border-radius: 4px; font-size: 13px; color: var(--red); }
        pre { font-family: 'IBM Plex Mono', monospace; background: #1e1e1e; color: #d4d4d4; padding: 20px; border-radius: 8px; overflow-x: auto; font-size: 12px; line-height: 1.5; margin: 16px 0; }
        pre code { background: none; padding: 0; color: inherit; }
        .diagram { background: var(--bg-secondary); border-radius: 8px; padding: 20px; margin: 16px 0; overflow-x: auto; }
        .diagram pre { background: none; color: var(--text); padding: 0; margin: 0; font-size: 11px; line-height: 1.4; }
        details { margin: 12px 0; border: 1px solid var(--border); border-radius: 6px; }
        summary { cursor: pointer; padding: 14px 16px; font-weight: 500; background: var(--bg-secondary); border-radius: 6px; list-style: none; display: flex; align-items: center; gap: 8px; }
        summary::before { content: 'â–¶'; font-size: 10px; color: var(--text-light); transition: transform 0.2s; }
        details[open] summary::before { transform: rotate(90deg); }
        details[open] summary { border-radius: 6px 6px 0 0; }
        summary::-webkit-details-marker { display: none; }
        details > .content { padding: 20px; }
        .toc { background: var(--bg-secondary); padding: 20px; border-radius: 8px; margin: 24px 0; }
        .toc-title { font-weight: 600; margin-bottom: 12px; }
        .toc-item { display: block; padding: 6px 0; color: var(--text-secondary); font-size: 14px; }
        .toc-item:hover { color: var(--blue); }
        .checklist { list-style: none; margin: 12px 0; }
        .checklist li { display: flex; align-items: flex-start; gap: 8px; padding: 4px 0; }
        .checklist li::before { content: 'âœ“'; color: var(--green); font-weight: 600; }
        ul.bullet { list-style: none; margin: 8px 0; }
        ul.bullet li { position: relative; padding-left: 20px; margin: 4px 0; }
        ul.bullet li::before { content: 'â€¢'; position: absolute; left: 6px; color: var(--text-light); }
        ol.numbered { margin: 8px 0 8px 24px; }
        ol.numbered li { margin: 6px 0; }
        .columns { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin: 16px 0; }
        .column { padding: 16px; background: var(--bg-secondary); border-radius: 8px; }
        .column h4 { margin-top: 0; }
        .page-footer { margin-top: 60px; padding-top: 20px; border-top: 1px solid var(--border); color: var(--text-light); font-size: 13px; text-align: center; }
        .security-box { background: linear-gradient(135deg, var(--green-bg) 0%, var(--blue-bg) 100%); padding: 20px; border-radius: 8px; margin: 16px 0; }
        .security-item { display: flex; align-items: flex-start; gap: 12px; padding: 10px 0; border-bottom: 1px solid rgba(0,0,0,0.1); }
        .security-item:last-child { border-bottom: none; }
        .security-icon { font-size: 18px; }
    </style>
</head>
<body>
    <div class="page">
        <!-- Header -->
        <header class="page-header">
            <div class="page-icon">ğŸ“Š</div>
            <h1 class="page-title">Biohelp LRP<span class="status-badge">Sprint 7 âœ… CONCLUÃDO</span></h1>
            <p class="page-description">Status do Projeto â€” MVP COMPLETO + DECISÃ•ES IMPLEMENTADAS<br>Ãšltima atualizaÃ§Ã£o: 18/02/2026</p>
        </header>

        <!-- Progress Overview -->
        <section class="progress-section">
            <div class="progress-item">
                <span class="progress-label">Sprint 1 â€” MVP Operacional</span>
                <div class="progress-bar"><div class="progress-fill" style="width: 100%"></div></div>
                <span class="progress-value">100% âœ…</span>
            </div>
            <div class="progress-item">
                <span class="progress-label">Sprint 2 â€” CV + Status</span>
                <div class="progress-bar"><div class="progress-fill" style="width: 100%"></div></div>
                <span class="progress-value">100% âœ…</span>
            </div>
            <div class="progress-item">
                <span class="progress-label">Sprint 3 â€” Rede Visual</span>
                <div class="progress-bar"><div class="progress-fill" style="width: 100%"></div></div>
                <span class="progress-value">100% âœ…</span>
            </div>
            <div class="progress-item">
                <span class="progress-label">Sprint 4 â€” ComissÃµes</span>
                <div class="progress-bar"><div class="progress-fill" style="width: 100%"></div></div>
                <span class="progress-value">100% âœ…</span>
            </div>
            <div class="progress-item">
                <span class="progress-label">Sprint 5 â€” Saques</span>
                <div class="progress-bar"><div class="progress-fill" style="width: 92%"></div></div>
                <span class="progress-value">92% âœ…</span>
            </div>
            <div class="progress-item">
                <span class="progress-label">Sprint 6 â€” Admin AvanÃ§ado</span>
                <div class="progress-bar"><div class="progress-fill" style="width: 100%"></div></div>
                <span class="progress-value">100% âœ…</span>
            </div>
            <div class="progress-item">
                <span class="progress-label">Sprint 7 â€” Creatina + DecisÃµes</span>
                <div class="progress-bar"><div class="progress-fill" style="width: 100%"></div></div>
                <span class="progress-value">100% âœ…</span>
            </div>
        </section>

        <!-- Cobertura FRs -->
        <h3>Cobertura de Requisitos Funcionais (FRs)</h3>
        <table>
            <thead><tr><th>Categoria</th><th>Total</th><th>âœ…</th><th>âš ï¸</th><th>â³</th><th>%</th></tr></thead>
            <tbody>
                <tr><td>Identidade/Acesso</td><td>3</td><td>3</td><td>0</td><td>0</td><td>100%</td></tr>
                <tr><td>Cadastro/IndicaÃ§Ã£o</td><td>5</td><td>5</td><td>0</td><td>0</td><td>100%</td></tr>
                <tr><td>Rede/VisualizaÃ§Ã£o</td><td>4</td><td>4</td><td>0</td><td>0</td><td>100%</td></tr>
                <tr><td>CV/Status</td><td>5</td><td>5</td><td>0</td><td>0</td><td>100%</td></tr>
                <tr><td>NÃ­veis</td><td>3</td><td>3</td><td>0</td><td>0</td><td>100%</td></tr>
                <tr><td>ComissÃµes</td><td>7</td><td>7</td><td>0</td><td>0</td><td>100%</td></tr>
                <tr><td>Saques</td><td>6</td><td>5</td><td>1</td><td>0</td><td>92%</td></tr>
                <tr><td>Admin</td><td>5</td><td>5</td><td>0</td><td>0</td><td>100%</td></tr>
                <tr style="font-weight: 600; background: var(--green-bg);"><td>TOTAL</td><td>38</td><td>37</td><td>1</td><td>0</td><td>98%</td></tr>
            </tbody>
        </table>

        <hr>

        <!-- TOC -->
        <nav class="toc">
            <div class="toc-title">ğŸ“‹ Ãndice</div>
            <a class="toc-item" href="#sprint1">ğŸš€ Sprint 1 â€” MVP Operacional</a>
            <a class="toc-item" href="#sprint2">ğŸ“Š Sprint 2 â€” CV + Status</a>
            <a class="toc-item" href="#sprint3">ğŸŒ Sprint 3 â€” Rede Visual + NÃ­veis</a>
            <a class="toc-item" href="#sprint4">ğŸ’° Sprint 4 â€” ComissÃµes + Ledger</a>
            <a class="toc-item" href="#sprint5">ğŸ’¸ Sprint 5 â€” Saques + Fiscal</a>
            <a class="toc-item" href="#sprint6">ğŸ† Sprint 6 â€” Admin AvanÃ§ado</a>
            <a class="toc-item" href="#sprint7">ğŸ Sprint 7 â€” Creatina + DecisÃµes</a>
            <a class="toc-item" href="#testar">ğŸ§ª Como Testar</a>
            <a class="toc-item" href="#testes-realizados">ğŸ§ª Testes Realizados</a>
            <a class="toc-item" href="#tipos-compra">ğŸ“Š Tipos de Compra</a>
            <a class="toc-item" href="#tbd">ğŸ“‹ DecisÃµes (TBD)</a>
            <a class="toc-item" href="#checklist">âœ… Checklist de Aceite</a>
        </nav>

        <hr>

        <!-- SPRINT 1 -->
        <section id="sprint1">
            <h1>ğŸš€ Sprint 1 â€” MVP Operacional âœ…</h1>
            <p><strong>Data de conclusÃ£o:</strong> 07/01/2026 | <strong>FRs cobertos:</strong> FR-01 a FR-09</p>

            <h3>O que foi entregue</h3>
            <table>
                <thead><tr><th>#</th><th>Funcionalidade</th><th>FR</th><th>Status</th><th>DescriÃ§Ã£o</th></tr></thead>
                <tbody>
                    <tr><td>1</td><td>Cadastro com link</td><td>FR-04, FR-05</td><td><span class="tag green">âœ…</span></td><td>Cliente recebe link e se cadastra</td></tr>
                    <tr><td>2</td><td>Cadastro sem link</td><td>FR-06</td><td><span class="tag green">âœ…</span></td><td>Sem link â†’ sponsor = House Account (TBD-001)</td></tr>
                    <tr><td>3</td><td>AutenticaÃ§Ã£o membro</td><td>FR-01</td><td><span class="tag green">âœ…</span></td><td>Login/logout via Supabase Auth</td></tr>
                    <tr><td>4</td><td>AutenticaÃ§Ã£o admin</td><td>FR-02</td><td><span class="tag green">âœ…</span></td><td>Login com role admin</td></tr>
                    <tr><td>5</td><td>Controle de permissÃµes</td><td>FR-03</td><td><span class="tag green">âœ…</span></td><td>RLS ativo no banco</td></tr>
                    <tr><td>6</td><td>Dashboard do membro</td><td>FR-01</td><td><span class="tag green">âœ…</span></td><td>Painel com dados e link de convite</td></tr>
                    <tr><td>7</td><td>Painel administrativo</td><td>FR-02</td><td><span class="tag green">âœ…</span></td><td>Lista, busca e gerencia membros</td></tr>
                    <tr><td>8</td><td>IntegraÃ§Ã£o Shopify</td><td>FR-04, FR-08</td><td><span class="tag green">âœ…</span></td><td>Cria/atualiza customer com tags (incluindo nivel:)</td></tr>
                    <tr><td>9</td><td>GeraÃ§Ã£o de ref_code</td><td>FR-07</td><td><span class="tag green">âœ…</span></td><td>Sequencial BH00001 + customizaÃ§Ã£o admin</td></tr>
                    <tr><td>10</td><td>PersistÃªncia da rede</td><td>FR-09</td><td><span class="tag green">âœ…</span></td><td>sponsor_id vincula hierarquia</td></tr>
                </tbody>
            </table>

            <details open>
                <summary>ğŸ“‹ Fluxo de Cadastro de Novo Membro</summary>
                <div class="content">
                    <div class="diagram">
<pre>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        FLUXO DE CADASTRO (Sprint 1)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1ï¸âƒ£ PARCEIRA COMPARTILHA LINK
   â”‚
   â”‚  Exemplo: https://rlp-biohelp.vercel.app/join?ref=ABC123
   â”‚
   â–¼
2ï¸âƒ£ CLIENTE ACESSA O LINK
   â”‚
   â”‚  Sistema captura o ref_code (ABC123) da URL
   â”‚  Sistema busca o sponsor pelo ref_code
   â”‚
   â–¼
3ï¸âƒ£ CLIENTE PREENCHE FORMULÃRIO
   â”‚
   â”‚  Campos: Nome, Email, Senha
   â”‚
   â–¼
4ï¸âƒ£ SISTEMA VALIDA DADOS
   â”‚
   â”‚  âœ“ Email Ãºnico? (nÃ£o pode existir)
   â”‚  âœ“ Sponsor existe? (ref_code vÃ¡lido)
   â”‚  âœ“ Senha forte?
   â”‚
   â–¼
5ï¸âƒ£ SISTEMA CRIA MEMBRO NO SUPABASE
   â”‚
   â”‚  â”œâ”€â”€ Cria usuÃ¡rio no Supabase Auth
   â”‚  â”œâ”€â”€ Cria registro na tabela `members`
   â”‚  â”‚   â”œâ”€â”€ id: UUID gerado
   â”‚  â”‚   â”œâ”€â”€ name: nome do cliente
   â”‚  â”‚   â”œâ”€â”€ email: email do cliente
   â”‚  â”‚   â”œâ”€â”€ ref_code: cÃ³digo Ãºnico gerado (ex: BH00001)
   â”‚  â”‚   â”œâ”€â”€ sponsor_id: UUID do sponsor (quem indicou)
   â”‚  â”‚   â””â”€â”€ status: 'pending'
   â”‚  â”œâ”€â”€ Cria registro em `referral_events` (histÃ³rico)
   â”‚  â””â”€â”€ Cria registro em `shopify_customers` (status: pending)
   â”‚
   â–¼
6ï¸âƒ£ SISTEMA SINCRONIZA COM SHOPIFY
   â”‚
   â”‚  Mutation GraphQL: customerSet
   â”‚  â”œâ”€â”€ Cria/atualiza Customer por email
   â”‚  â””â”€â”€ Aplica tags:
   â”‚      â”œâ”€â”€ lrp_member (identifica como membro LRP)
   â”‚      â”œâ”€â”€ lrp_ref:BH00001 (cÃ³digo sequencial do novo membro)
   â”‚      â”œâ”€â”€ lrp_sponsor:ABC123 (cÃ³digo de quem indicou)
   â”‚      â”œâ”€â”€ lrp_status:active (status atual)
   â”‚      â””â”€â”€ nivel:membro (nÃ­vel de lideranÃ§a â€” TBD-003)
   â”‚
   â–¼
7ï¸âƒ£ SISTEMA REDIRECIONA PARA DASHBOARD
   â”‚
   â”‚  Membro vÃª:
   â”‚  â”œâ”€â”€ Seu nome e email
   â”‚  â”œâ”€â”€ Seu link de convite (para indicar outros)
   â”‚  â”œâ”€â”€ Quem o indicou (sponsor)
   â”‚  â””â”€â”€ Status: Pendente
   â”‚
   â–¼
8ï¸âƒ£ MEMBRO PODE COMPRAR COM PREÃ‡O DE MEMBRO
   â”‚
   â”‚  Na loja Shopify, o sistema reconhece a tag lrp_member
   â”‚  e libera preÃ§os especiais para membros
   â”‚
   â””â”€â”€ FIM DO FLUXO</pre>
                    </div>
                </div>
            </details>

            <details>
                <summary>ğŸ—ï¸ Diagrama de Arquitetura</summary>
                <div class="content">
                    <div class="diagram">
<pre>    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   CLIENTE    â”‚â”€â”€â”€â”€â–¶â”‚   SISTEMA    â”‚â”€â”€â”€â”€â–¶â”‚   SHOPIFY    â”‚
    â”‚  (Browser)   â”‚     â”‚  (Next.js)   â”‚     â”‚  (Customer)  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                    â”‚                    â”‚
           â”‚  1. Acessa link    â”‚                    â”‚
           â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚                    â”‚
           â”‚  2. Preenche form  â”‚                    â”‚
           â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚                    â”‚
           â”‚                    â”‚  3. Cria Customer  â”‚
           â”‚                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
           â”‚                    â”‚  4. Aplica Tags    â”‚
           â”‚                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
           â”‚  5. Dashboard      â”‚                    â”‚
           â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚                    â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   SUPABASE   â”‚â—€â”€â”€â”€â”€â”‚   SISTEMA    â”‚
    â”‚  (Auth+DB)   â”‚     â”‚  (Backend)   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</pre>
                    </div>
                </div>
            </details>

            <details>
                <summary>ğŸ§ª Testes Realizados</summary>
                <div class="content">
                    <h4>CenÃ¡rio 1: Cadastro com link vÃ¡lido âœ…</h4>
                    <table>
                        <thead><tr><th>Passo</th><th>AÃ§Ã£o</th><th>Resultado Esperado</th><th>Status</th></tr></thead>
                        <tbody>
                            <tr><td>1</td><td>Acessar /join?ref=SPONSOR01</td><td>PÃ¡gina de cadastro carrega</td><td><span class="tag green">âœ…</span></td></tr>
                            <tr><td>2</td><td>Preencher nome, email, senha</td><td>FormulÃ¡rio aceita dados</td><td><span class="tag green">âœ…</span></td></tr>
                            <tr><td>3</td><td>Clicar em "Cadastrar"</td><td>Processamento inicia</td><td><span class="tag green">âœ…</span></td></tr>
                            <tr><td>4</td><td>Verificar Supabase</td><td>Registro em members criado</td><td><span class="tag green">âœ…</span></td></tr>
                            <tr><td>5</td><td>Verificar Shopify Admin</td><td>Customer existe com tags</td><td><span class="tag green">âœ…</span></td></tr>
                            <tr><td>6</td><td>Verificar redirect</td><td>Dashboard carrega</td><td><span class="tag green">âœ…</span></td></tr>
                        </tbody>
                    </table>

                    <h4>CenÃ¡rio 2: Email duplicado âœ…</h4>
                    <table>
                        <thead><tr><th>Passo</th><th>AÃ§Ã£o</th><th>Resultado</th><th>Status</th></tr></thead>
                        <tbody>
                            <tr><td>1</td><td>Tentar cadastrar email existente</td><td>Erro 409</td><td><span class="tag green">âœ…</span></td></tr>
                            <tr><td>2</td><td>Mensagem exibida</td><td>"Email jÃ¡ cadastrado"</td><td><span class="tag green">âœ…</span></td></tr>
                            <tr><td>3</td><td>Shopify</td><td>NÃ£o cria duplicado</td><td><span class="tag green">âœ…</span></td></tr>
                        </tbody>
                    </table>
                </div>
            </details>

            <h4>EvidÃªncias no Shopify Admin</h4>
            <p>ApÃ³s cadastro bem-sucedido, o Customer deve ter:</p>
            <ul class="bullet">
                <li>âœ… Email do membro</li>
                <li>âœ… Tag <code>lrp_member</code></li>
                <li>âœ… Tag <code>lrp_ref:&lt;ref_code&gt;</code> (ex: lrp_ref:BH00001)</li>
                <li>âœ… Tag <code>lrp_sponsor:&lt;sponsor_ref_code&gt;</code></li>
                <li>âœ… Tag <code>lrp_status:active</code></li>
                <li>âœ… Tag <code>nivel:membro</code></li>
            </ul>

            <h4>Banco de Dados Criado</h4>
            <table>
                <thead><tr><th>Tabela</th><th>DescriÃ§Ã£o</th><th>Campos principais</th></tr></thead>
                <tbody>
                    <tr><td><code>members</code></td><td>Cadastro de membros</td><td>id, name, email, ref_code, sponsor_id, status</td></tr>
                    <tr><td><code>referral_events</code></td><td>HistÃ³rico de indicaÃ§Ãµes</td><td>member_id, ref_code_used, utm_json</td></tr>
                    <tr><td><code>shopify_customers</code></td><td>Rastreamento de sync</td><td>member_id, shopify_customer_id, last_sync_status</td></tr>
                    <tr><td><code>roles</code></td><td>Controle de permissÃµes</td><td>member_id, role (member/admin)</td></tr>
                </tbody>
            </table>
        </section>

        <hr>

        <!-- SPRINT 2 -->
        <section id="sprint2">
            <h1>ğŸ“Š Sprint 2 â€” CV + Status âœ…</h1>
            <p><strong>Data de conclusÃ£o:</strong> 08/01/2026 | <strong>FRs cobertos:</strong> FR-13, FR-14, FR-15, FR-16</p>

            <h3>O que foi entregue</h3>
            <table>
                <thead><tr><th>#</th><th>Funcionalidade</th><th>FR</th><th>Status</th><th>DescriÃ§Ã£o</th></tr></thead>
                <tbody>
                    <tr><td>1</td><td>Webhooks Shopify</td><td>FR-13</td><td><span class="tag green">âœ…</span></td><td>Recebe eventos de pedidos</td></tr>
                    <tr><td>2</td><td>CÃ¡lculo de CV</td><td>FR-14</td><td><span class="tag green">âœ…</span></td><td>CV por produto via metafield</td></tr>
                    <tr><td>3</td><td>Status automÃ¡tico</td><td>FR-15</td><td><span class="tag green">âœ…</span></td><td>Ativo se CV >= 200/mÃªs</td></tr>
                    <tr><td>4</td><td>Dashboard com CV</td><td>FR-14</td><td><span class="tag green">âœ…</span></td><td>Progresso visual da meta</td></tr>
                    <tr><td>5</td><td>HistÃ³rico de CV</td><td>FR-14</td><td><span class="tag green">âœ…</span></td><td>Meses anteriores</td></tr>
                    <tr><td>6</td><td>Job mensal</td><td>FR-16</td><td><span class="tag green">âœ…</span></td><td>Fechamento automÃ¡tico</td></tr>
                    <tr><td>7</td><td>Ajuste manual</td><td>FR-14</td><td><span class="tag green">âœ…</span></td><td>Admin pode ajustar CV</td></tr>
                </tbody>
            </table>

            <div class="callout yellow">
                <span class="callout-icon">âš ï¸</span>
                <div class="callout-content">
                    <strong>CV Ã© definido por PRODUTO, NÃƒO pelo preÃ§o!</strong>
                    <p>Cada produto tem um CV especÃ­fico configurado via metafield no Shopify.<br>
                    Exemplo: Lemon Dreams custa R$159 mas tem CV = 77</p>
                </div>
            </div>

            <details open>
                <summary>ğŸ“‹ Fluxo de Compra â†’ CV</summary>
                <div class="content">
                    <div class="diagram">
<pre>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FLUXO DE COMPRA â†’ CV (Sprint 2)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1ï¸âƒ£ MEMBRO FAZ COMPRA NA LOJA SHOPIFY
   â”‚
   â”‚  Usa o email cadastrado no LRP
   â”‚  Compra produtos (ex: Lemon Dreams R$159)
   â”‚
   â–¼
2ï¸âƒ£ SHOPIFY PROCESSA PAGAMENTO
   â”‚
   â”‚  Pedido muda para status "paid"
   â”‚  Shopify dispara webhook
   â”‚
   â–¼
3ï¸âƒ£ WEBHOOK CHEGA NO SISTEMA
   â”‚
   â”‚  POST /api/webhooks/shopify/orders/paid
   â”‚  Payload: dados completos do pedido
   â”‚
   â–¼
4ï¸âƒ£ SISTEMA VALIDA WEBHOOK
   â”‚
   â”‚  âœ“ Assinatura HMAC vÃ¡lida?
   â”‚  âœ“ DomÃ­nio da loja correto?
   â”‚  âœ“ Pedido jÃ¡ processado? (idempotÃªncia)
   â”‚
   â–¼
5ï¸âƒ£ SISTEMA IDENTIFICA MEMBRO
   â”‚
   â”‚  Busca membro pelo email do pedido
   â”‚  Se nÃ£o encontrar â†’ ignora (nÃ£o Ã© membro LRP)
   â”‚
   â–¼
6ï¸âƒ£ SISTEMA CALCULA CV DO PEDIDO
   â”‚
   â”‚  Para cada item do pedido:
   â”‚  â”œâ”€â”€ Busca CV no metafield do produto
   â”‚  â”‚   (ex: Lemon Dreams â†’ CV = 77)
   â”‚  â””â”€â”€ CV_item = CV_produto Ã— quantidade
   â”‚
   â”‚  CV_pedido = Î£(CV_item)
   â”‚
   â”‚  âš ï¸ IMPORTANTE: CV â‰  PreÃ§o!
   â”‚
   â–¼
7ï¸âƒ£ SISTEMA REGISTRA NO BANCO
   â”‚
   â”‚  â”œâ”€â”€ Cria registro em `orders`
   â”‚  â”œâ”€â”€ Cria registros em `order_items`
   â”‚  â”œâ”€â”€ Cria entradas no `cv_ledger`
   â”‚  â””â”€â”€ Atualiza `members.current_cv_month`
   â”‚
   â–¼
8ï¸âƒ£ SISTEMA VERIFICA STATUS
   â”‚
   â”‚  Se CV_mensal >= 200: Status = "active" âœ…
   â”‚  Se CV_mensal < 200: Status = "inactive" ou "pending"
   â”‚
   â–¼
9ï¸âƒ£ SISTEMA ATUALIZA SHOPIFY
   â”‚
   â”‚  Atualiza tag do Customer:
   â”‚  â””â”€â”€ lrp_status:active (ou inactive)
   â”‚
   â””â”€â”€ FIM DO FLUXO</pre>
                    </div>
                </div>
            </details>

            <details>
                <summary>ğŸ”„ Fluxo de Refund/Cancelamento</summary>
                <div class="content">
                    <div class="diagram">
<pre>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FLUXO DE REFUND/CANCEL (Sprint 2)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1ï¸âƒ£ ADMIN FAZ REFUND NO SHOPIFY
   â”‚
   â–¼
2ï¸âƒ£ SHOPIFY DISPARA WEBHOOK
   â”‚
   â”‚  POST /api/webhooks/shopify/orders/refunded
   â”‚  (ou /orders/cancelled)
   â”‚
   â–¼
3ï¸âƒ£ SISTEMA PROCESSA REVERSÃƒO
   â”‚
   â”‚  â”œâ”€â”€ Busca pedido original
   â”‚  â”œâ”€â”€ Cria entradas NEGATIVAS no cv_ledger
   â”‚  â”‚   (cv_type = 'order_refunded' ou 'order_cancelled')
   â”‚  â””â”€â”€ Recalcula CV mensal do membro
   â”‚
   â–¼
4ï¸âƒ£ SISTEMA VERIFICA NOVO STATUS
   â”‚
   â”‚  Se CV_mensal < 200 apÃ³s reversÃ£o:
   â”‚  â””â”€â”€ Status muda para "inactive"
   â”‚
   â–¼
5ï¸âƒ£ SISTEMA ATUALIZA SHOPIFY
   â”‚
   â”‚  Atualiza tag: lrp_status:inactive
   â”‚
   â””â”€â”€ FIM DO FLUXO</pre>
                    </div>
                </div>
            </details>

            <details>
                <summary>ğŸ“… Fluxo de Fechamento Mensal</summary>
                <div class="content">
                    <div class="diagram">
<pre>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FLUXO DE FECHAMENTO MENSAL (Sprint 2)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â° EXECUÃ‡ÃƒO: 1Âº dia do mÃªs Ã s 03:00 UTC (00:00 BRT)
   â”‚
   â”‚  Cron job: /api/cron/close-monthly-cv
   â”‚
   â–¼
Para cada membro:
   â”‚
   â”œâ”€â”€ 1ï¸âƒ£ Calcula CV do mÃªs anterior
   â”‚   â”‚   (soma do cv_ledger do mÃªs)
   â”‚   â”‚
   â”œâ”€â”€ 2ï¸âƒ£ Determina status final
   â”‚   â”‚   >= 200 â†’ active
   â”‚   â”‚   < 200 â†’ inactive
   â”‚   â”‚
   â”œâ”€â”€ 3ï¸âƒ£ Cria/atualiza cv_monthly_summary
   â”‚   â”‚   (total_cv, status_at_close, closed_at)
   â”‚   â”‚
   â”œâ”€â”€ 4ï¸âƒ£ Reseta CV para novo mÃªs
   â”‚   â”‚   members.current_cv_month = 0
   â”‚   â”‚
   â””â”€â”€ 5ï¸âƒ£ Atualiza tag no Shopify (se mudou)
       â”‚
       â””â”€â”€ FIM DO FLUXO</pre>
                    </div>
                </div>
            </details>

            <h4>Regras de CV</h4>
            <div class="diagram">
<pre>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Cada produto tem um CV especÃ­fico configurado via metafield no Shopify.    â”‚
â”‚                                                                             â”‚
â”‚  Exemplo:                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”‚
â”‚  â”‚ Produto         â”‚ PreÃ§o    â”‚ CV     â”‚                                    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                    â”‚
â”‚  â”‚ Lemon Dreams    â”‚ R$ 159   â”‚ 77     â”‚                                    â”‚
â”‚  â”‚ Produto B       â”‚ R$ 200   â”‚ 100    â”‚                                    â”‚
â”‚  â”‚ Produto C       â”‚ R$ 50    â”‚ 25     â”‚                                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚
â”‚                                                                             â”‚
â”‚  CV do pedido = Î£(CV_do_produto Ã— quantidade)                               â”‚
â”‚                                                                             â”‚
â”‚  Status:                                                                    â”‚
â”‚  â”œâ”€â”€ pending: recÃ©m-cadastrado, antes de qualquer ciclo                     â”‚
â”‚  â”œâ”€â”€ active: CV mensal >= 200                                               â”‚
â”‚  â””â”€â”€ inactive: CV mensal < 200 (apÃ³s fechamento do mÃªs)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</pre>
            </div>

            <h4>Banco de Dados Criado</h4>
            <table>
                <thead><tr><th>Tabela</th><th>DescriÃ§Ã£o</th><th>Campos principais</th></tr></thead>
                <tbody>
                    <tr><td><code>orders</code></td><td>Espelho dos pedidos Shopify</td><td>shopify_order_id, member_id, total_cv, status</td></tr>
                    <tr><td><code>order_items</code></td><td>Itens dos pedidos</td><td>order_id, title, quantity, price, cv_value</td></tr>
                    <tr><td><code>cv_ledger</code></td><td>Ledger auditÃ¡vel de CV</td><td>member_id, order_id, cv_amount, cv_type, month_year</td></tr>
                    <tr><td><code>cv_monthly_summary</code></td><td>Resumo mensal por membro</td><td>member_id, month_year, total_cv, status_at_close</td></tr>
                </tbody>
            </table>
        </section>

        <hr>

        <!-- SPRINT 3 -->
        <section id="sprint3">
            <h1>ğŸŒ Sprint 3 â€” Rede Visual + NÃ­veis âœ…</h1>
            <p><strong>Data de conclusÃ£o:</strong> 09/01/2026 | <strong>FRs cobertos:</strong> FR-10, FR-11, FR-17 (parcial), FR-18, FR-19, FR-20</p>

            <h3>O que foi entregue</h3>
            <table>
                <thead><tr><th>#</th><th>Funcionalidade</th><th>FR</th><th>Status</th><th>DescriÃ§Ã£o</th></tr></thead>
                <tbody>
                    <tr><td>1</td><td>VisualizaÃ§Ã£o da rede (membro)</td><td>FR-10</td><td><span class="tag green">âœ…</span></td><td>Ãrvore visual com toda a rede</td></tr>
                    <tr><td>2</td><td>VisualizaÃ§Ã£o da rede (admin)</td><td>FR-11</td><td><span class="tag green">âœ…</span></td><td>Admin vÃª rede de qualquer membro</td></tr>
                    <tr><td>3</td><td>NÃ­veis de lideranÃ§a</td><td>FR-18</td><td><span class="tag green">âœ…</span></td><td>CÃ¡lculo automÃ¡tico de nÃ­vel</td></tr>
                    <tr><td>4</td><td>Progresso para prÃ³ximo nÃ­vel</td><td>FR-18</td><td><span class="tag green">âœ…</span></td><td>Requisitos e % de conclusÃ£o</td></tr>
                    <tr><td>5</td><td>LÃ­der em FormaÃ§Ã£o (90 dias)</td><td>FR-19</td><td><span class="tag green">âœ…</span></td><td>Janela de promoÃ§Ã£o temporÃ¡ria</td></tr>
                    <tr><td>6</td><td>Rebaixamento automÃ¡tico</td><td>FR-20</td><td><span class="tag green">âœ…</span></td><td>Perde nÃ­vel se nÃ£o mantiver requisitos</td></tr>
                </tbody>
            </table>

            <details open>
                <summary>ğŸ“‹ Fluxo de VisualizaÃ§Ã£o da Rede</summary>
                <div class="content">
                    <div class="diagram">
<pre>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FLUXO DE VISUALIZAÃ‡ÃƒO DA REDE (Sprint 3)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1ï¸âƒ£ MEMBRO ACESSA "MINHA REDE"
   â”‚
   â”‚  URL: /dashboard/network
   â”‚
   â–¼
2ï¸âƒ£ SISTEMA BUSCA REDE COMPLETA
   â”‚
   â”‚  FunÃ§Ã£o RPC: get_network_tree(member_id)
   â”‚  â”œâ”€â”€ CTE recursiva no banco
   â”‚  â”œâ”€â”€ Busca todos os indicados (N1, N2, N3...)
   â”‚  â””â”€â”€ Limite tÃ©cnico: 20 nÃ­veis de profundidade
   â”‚
   â–¼
3ï¸âƒ£ SISTEMA APLICA LAZY LOADING
   â”‚
   â”‚  Para redes grandes:
   â”‚  â”œâ”€â”€ Carrega N1 imediatamente
   â”‚  â””â”€â”€ Carrega N2+ sob demanda (expand/collapse)
   â”‚
   â–¼
4ï¸âƒ£ EXIBE ÃRVORE VISUAL
   â”‚
   â”‚  Componente: NetworkTree
   â”‚  â”‚
   â”‚  â”‚  VocÃª (N0)
   â”‚  â”‚  â”œâ”€â”€ Maria (N1) - Parceira - Ativa - CV: 350
   â”‚  â”‚  â”‚   â”œâ”€â”€ Ana (N2) - Membro - Ativa - CV: 220
   â”‚  â”‚  â”‚   â””â”€â”€ Carla (N2) - Membro - Inativa - CV: 50
   â”‚  â”‚  â”œâ”€â”€ Julia (N1) - Membro - Ativa - CV: 200
   â”‚  â”‚  â””â”€â”€ Paula (N1) - Membro - Pendente - CV: 0
   â”‚  â”‚
   â”‚  Cada nÃ³ mostra:
   â”‚  â”œâ”€â”€ Nome
   â”‚  â”œâ”€â”€ NÃ­vel de lideranÃ§a
   â”‚  â”œâ”€â”€ Status (ativo/inativo/pendente)
   â”‚  â””â”€â”€ CV do mÃªs
   â”‚
   â–¼
5ï¸âƒ£ EXIBE ESTATÃSTICAS DA REDE
   â”‚
   â”‚  â”œâ”€â”€ Total de membros na rede
   â”‚  â”œâ”€â”€ Membros ativos
   â”‚  â”œâ”€â”€ CV total da rede
   â”‚  â””â”€â”€ DistribuiÃ§Ã£o por nÃ­vel
   â”‚
   â””â”€â”€ FIM DO FLUXO</pre>
                    </div>
                </div>
            </details>

            <details>
                <summary>ğŸ“Š Fluxo de CÃ¡lculo de NÃ­veis</summary>
                <div class="content">
                    <div class="diagram">
<pre>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FLUXO DE CÃLCULO DE NÃVEIS (Sprint 3)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1ï¸âƒ£ TRIGGER: ApÃ³s qualquer mudanÃ§a de CV ou status
   â”‚
   â–¼
2ï¸âƒ£ SISTEMA AVALIA REQUISITOS
   â”‚
   â”‚  FunÃ§Ã£o: calculateLevel(member_id)
   â”‚  â”‚
   â”‚  â”‚  Verifica de cima para baixo:
   â”‚  â”‚
   â”‚  â”‚  HEAD?
   â”‚  â”‚  â”œâ”€â”€ 3 Diretoras Ativas em N1?
   â”‚  â”‚  â””â”€â”€ 200.000 CV na rede?
   â”‚  â”‚  Se SIM â†’ nÃ­vel = 'head'
   â”‚  â”‚
   â”‚  â”‚  DIRETORA?
   â”‚  â”‚  â”œâ”€â”€ 3 LÃ­deres Ativas em N1?
   â”‚  â”‚  â””â”€â”€ 80.000 CV na rede?
   â”‚  â”‚  Se SIM â†’ nÃ­vel = 'diretora'
   â”‚  â”‚
   â”‚  â”‚  LÃDER?
   â”‚  â”‚  â”œâ”€â”€ Parceira Ativa?
   â”‚  â”‚  â””â”€â”€ 4 Parceiras Ativas em N1?
   â”‚  â”‚  Se SIM â†’ nÃ­vel = 'lider'
   â”‚  â”‚
   â”‚  â”‚  LÃDER EM FORMAÃ‡ÃƒO?
   â”‚  â”‚  â”œâ”€â”€ Parceira?
   â”‚  â”‚  â”œâ”€â”€ Primeira Parceira em N1?
   â”‚  â”‚  â””â”€â”€ Dentro da janela de 90 dias?
   â”‚  â”‚  Se SIM â†’ nÃ­vel = 'lider_formacao'
   â”‚  â”‚
   â”‚  â”‚  PARCEIRA?
   â”‚  â”‚  â”œâ”€â”€ Membro Ativo (CV >= 200)?
   â”‚  â”‚  â””â”€â”€ CV_rede >= 500?
   â”‚  â”‚  Se SIM â†’ nÃ­vel = 'parceira'
   â”‚  â”‚
   â”‚  â”‚  SenÃ£o â†’ nÃ­vel = 'membro'
   â”‚
   â–¼
3ï¸âƒ£ SISTEMA ATUALIZA NÃVEL
   â”‚
   â”‚  â”œâ”€â”€ Atualiza members.level
   â”‚  â”œâ”€â”€ Registra em member_level_history (auditoria)
   â”‚  â””â”€â”€ Atualiza level_updated_at
   â”‚
   â–¼
4ï¸âƒ£ SISTEMA VERIFICA REBAIXAMENTO
   â”‚
   â”‚  Se nÃ­vel anterior > nÃ­vel atual:
   â”‚  â””â”€â”€ Registra motivo do rebaixamento
   â”‚
   â””â”€â”€ FIM DO FLUXO</pre>
                    </div>
                </div>
            </details>

            <h3>NÃ­veis de LideranÃ§a</h3>
            <table>
                <thead><tr><th>NÃ­vel</th><th>Requisitos</th><th>BenefÃ­cios</th></tr></thead>
                <tbody>
                    <tr><td><strong>Membro</strong></td><td>Cliente cadastrada</td><td>PreÃ§o de membro</td></tr>
                    <tr><td><strong>Parceira</strong></td><td>Membro Ativo + CV_rede >= 500</td><td>ComissÃ£o 5% de clientes N1</td></tr>
                    <tr><td><strong>LÃ­der em FormaÃ§Ã£o</strong></td><td>Parceira + 1Âª Parceira em N1 (90 dias)</td><td>ComissÃ£o como LÃ­der por 90 dias</td></tr>
                    <tr><td><strong>LÃ­der</strong></td><td>Parceira Ativa + 4 Parceiras Ativas em N1</td><td>ComissÃ£o 7% da rede</td></tr>
                    <tr><td><strong>Diretora</strong></td><td>3 LÃ­deres Ativas em N1 + 80.000 CV na rede</td><td>Leadership 3% + ComissÃ£o 10%</td></tr>
                    <tr><td><strong>Head</strong></td><td>3 Diretoras Ativas em N1 + 200.000 CV na rede</td><td>Leadership 4% + Royalty</td></tr>
                </tbody>
            </table>
        </section>

        <hr>

        <!-- SPRINT 4 -->
        <section id="sprint4">
            <h1>ğŸ’° Sprint 4 â€” ComissÃµes + Ledger âœ…</h1>
            <p><strong>Data de conclusÃ£o:</strong> 10/01/2026 | <strong>FRs cobertos:</strong> FR-21 a FR-27</p>

            <h3>O que foi entregue</h3>
            <table>
                <thead><tr><th>#</th><th>Funcionalidade</th><th>FR</th><th>Status</th><th>DescriÃ§Ã£o</th></tr></thead>
                <tbody>
                    <tr><td>1</td><td>Fast-Track</td><td>FR-22</td><td><span class="tag green">âœ…</span></td><td>30%/20% nos primeiros 60 dias</td></tr>
                    <tr><td>2</td><td>ComissÃ£o PerpÃ©tua</td><td>FR-23</td><td><span class="tag green">âœ…</span></td><td>Diferenciada por tipo de N1</td></tr>
                    <tr><td>3</td><td>BÃ´nus 3</td><td>FR-24</td><td><span class="tag green">âœ…</span></td><td>R$250 / R$1.500 / R$8.000</td></tr>
                    <tr><td>4</td><td>Leadership BÃ´nus</td><td>FR-25</td><td><span class="tag green">âœ…</span></td><td>3%/4% para Diretora/Head</td></tr>
                    <tr><td>5</td><td>Royalty</td><td>FR-26</td><td><span class="tag green">âœ…</span></td><td>3% quando Head forma Head</td></tr>
                    <tr><td>6</td><td>Dashboard de comissÃµes</td><td>FR-27</td><td><span class="tag green">âœ…</span></td><td>Saldo, histÃ³rico, detalhes</td></tr>
                    <tr><td>7</td><td>Ledger auditÃ¡vel</td><td>FR-21</td><td><span class="tag green">âœ…</span></td><td>Registro imutÃ¡vel</td></tr>
                </tbody>
            </table>

            <div class="callout red">
                <span class="callout-icon">ğŸš¨</span>
                <div class="callout-content">
                    <strong>ComissÃ£o PerpÃ©tua â€” REGRA IMPORTANTE!</strong>
                    <p>O percentual depende do nÃ­vel do SPONSOR E do tipo do COMPRADOR (N1)!</p>
                </div>
            </div>

            <details open>
                <summary>ğŸ“‹ Fluxo de CÃ¡lculo de ComissÃµes</summary>
                <div class="content">
                    <div class="diagram">
<pre>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FLUXO DE CÃLCULO DE COMISSÃ•ES (Sprint 4)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1ï¸âƒ£ PEDIDO PAGO (Webhook orders/paid)
   â”‚
   â”‚  Mesmo webhook do Sprint 2
   â”‚  ApÃ³s calcular CV, calcula comissÃµes
   â”‚
   â–¼
2ï¸âƒ£ IDENTIFICA COMPRADOR E SPONSOR
   â”‚
   â”‚  â”œâ”€â”€ Comprador: membro que fez a compra (N1)
   â”‚  â””â”€â”€ Sponsor: quem indicou o comprador (N0)
   â”‚
   â–¼
3ï¸âƒ£ VERIFICA JANELA FAST-TRACK
   â”‚
   â”‚  Busca em fast_track_windows:
   â”‚  â”œâ”€â”€ Comprador cadastrado hÃ¡ menos de 30 dias? â†’ Fast-Track 30%
   â”‚  â”œâ”€â”€ Comprador cadastrado entre 31-60 dias? â†’ Fast-Track 20%
   â”‚  â””â”€â”€ Comprador cadastrado hÃ¡ mais de 60 dias? â†’ ComissÃ£o PerpÃ©tua
   â”‚
   â–¼
4ï¸âƒ£ CALCULA FAST-TRACK (se aplicÃ¡vel)
   â”‚
   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  â”‚ PerÃ­odo      â”‚ N0 recebe de N1 â”‚ N0 recebe de N2 â”‚
   â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚  â”‚ Dias 1-30    â”‚ 30% CV          â”‚ 20% CV (LÃ­der)  â”‚
   â”‚  â”‚ Dias 31-60   â”‚ 20% CV          â”‚ 10% CV (LÃ­der)  â”‚
   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚
   â–¼
5ï¸âƒ£ CALCULA COMISSÃƒO PERPÃ‰TUA (se Fast-Track expirou)
   â”‚
   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  â”‚  NÃ­vel Sponsor   â”‚ Tipo de N1  â”‚   Percentual   â”‚
   â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚  â”‚  Parceira        â”‚ Cliente     â”‚ 5%             â”‚
   â”‚  â”‚  Parceira        â”‚ Parceira+   â”‚ 0% (NÃƒO recebe)â”‚
   â”‚  â”‚  LÃ­der           â”‚ Cliente     â”‚ 5%             â”‚
   â”‚  â”‚  LÃ­der           â”‚ Parceira+   â”‚ 7%             â”‚
   â”‚  â”‚  Diretora        â”‚ Cliente     â”‚ 5%             â”‚
   â”‚  â”‚  Diretora        â”‚ Parceira    â”‚ 7%             â”‚
   â”‚  â”‚  Diretora        â”‚ LÃ­der+      â”‚ 10%            â”‚
   â”‚  â”‚  Head            â”‚ Cliente     â”‚ 5%             â”‚
   â”‚  â”‚  Head            â”‚ Parceira    â”‚ 7%             â”‚
   â”‚  â”‚  Head            â”‚ LÃ­der       â”‚ 10%            â”‚
   â”‚  â”‚  Head            â”‚ Rede        â”‚ 15%            â”‚
   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚
   â–¼
6ï¸âƒ£ CALCULA LEADERSHIP BÃ”NUS (se aplicÃ¡vel)
   â”‚
   â”‚  Se Sponsor Ã© Diretora: 3% CV da rede
   â”‚  Se Sponsor Ã© Head: 4% CV da rede
   â”‚
   â–¼
7ï¸âƒ£ REGISTRA NO LEDGER
   â”‚
   â”‚  Para cada comissÃ£o calculada:
   â”‚  â”œâ”€â”€ Cria entrada em commission_ledger
   â”‚  â””â”€â”€ Atualiza commission_balances
   â”‚
   â””â”€â”€ FIM DO FLUXO</pre>
                    </div>
                </div>
            </details>

            <details>
                <summary>ğŸ Fluxo do BÃ´nus 3</summary>
                <div class="content">
                    <div class="diagram">
<pre>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FLUXO DO BÃ”NUS 3 (Sprint 4)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â° EXECUÃ‡ÃƒO: Mensal (junto com fechamento de CV)
   â”‚
   â–¼
Para cada membro:
   â”‚
   â”œâ”€â”€ 1ï¸âƒ£ CONTA PARCEIRAS ATIVAS EM N1
   â”‚   â”‚
   â”‚   â”‚   Se >= 3 Parceiras Ativas em N1 por 1 mÃªs:
   â”‚   â”‚   â””â”€â”€ Credita R$ 250 (BÃ´nus 3 NÃ­vel 1)
   â”‚   â”‚
   â”‚   â–¼
   â”œâ”€â”€ 2ï¸âƒ£ VERIFICA CADA N1
   â”‚   â”‚
   â”‚   â”‚   Para cada N1 que tem 3 Parceiras Ativas:
   â”‚   â”‚   â””â”€â”€ Credita R$ 1.500 (BÃ´nus 3 NÃ­vel 2)
   â”‚   â”‚
   â”‚   â–¼
   â””â”€â”€ 3ï¸âƒ£ VERIFICA CADA N2
       â”‚
       â”‚   Para cada N2 que tem 3 Parceiras Ativas:
       â”‚   â””â”€â”€ Credita R$ 8.000 (BÃ´nus 3 NÃ­vel 3)
       â”‚
       â””â”€â”€ FIM DO FLUXO</pre>
                    </div>
                </div>
            </details>

            <details>
                <summary>ğŸ‘‘ Fluxo do Royalty</summary>
                <div class="content">
                    <div class="diagram">
<pre>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FLUXO DO ROYALTY (Sprint 4)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1ï¸âƒ£ HEAD (N0) FORMA HEAD (N1)
   â”‚
   â”‚  N1 atinge requisitos de Head:
   â”‚  â”œâ”€â”€ 3 Diretoras Ativas em N1
   â”‚  â””â”€â”€ 200.000 CV na rede
   â”‚
   â–¼
2ï¸âƒ£ REDE DE N1 SE SEPARA
   â”‚
   â”‚  A rede abaixo de N1 agora pertence a N1
   â”‚  N0 nÃ£o perde status de Head (mantÃ©m sua rede)
   â”‚
   â–¼
3ï¸âƒ£ N0 RECEBE ROYALTY
   â”‚
   â”‚  Para cada pedido na rede de N1:
   â”‚  â””â”€â”€ N0 recebe 3% CV
   â”‚
   â”‚  Registrado em commission_ledger:
   â”‚  â””â”€â”€ commission_type = 'royalty'
   â”‚
   â””â”€â”€ FIM DO FLUXO</pre>
                    </div>
                </div>
            </details>

            <h3>Tabela de ComissÃ£o PerpÃ©tua</h3>
            <table>
                <thead><tr><th>NÃ­vel Sponsor</th><th>Tipo de N1</th><th>Percentual</th></tr></thead>
                <tbody>
                    <tr><td>Parceira</td><td>Cliente</td><td>5%</td></tr>
                    <tr><td>Parceira</td><td>Parceira+</td><td><span class="tag red">0% (NÃƒO recebe)</span></td></tr>
                    <tr><td>LÃ­der</td><td>Cliente</td><td>5%</td></tr>
                    <tr><td>LÃ­der</td><td>Parceira+</td><td>7%</td></tr>
                    <tr><td>Diretora</td><td>Cliente</td><td>5%</td></tr>
                    <tr><td>Diretora</td><td>Parceira</td><td>7%</td></tr>
                    <tr><td>Diretora</td><td>LÃ­der+</td><td>10%</td></tr>
                    <tr><td>Head</td><td>Cliente</td><td>5%</td></tr>
                    <tr><td>Head</td><td>Parceira</td><td>7%</td></tr>
                    <tr><td>Head</td><td>LÃ­der</td><td>10%</td></tr>
                    <tr><td>Head</td><td>Rede</td><td>15%</td></tr>
                </tbody>
            </table>
        </section>

        <hr>

        <!-- SPRINT 5 -->
        <section id="sprint5">
            <h1>ğŸ’¸ Sprint 5 â€” Saques + Fiscal âœ…</h1>
            <p><strong>Data de conclusÃ£o:</strong> 15/01/2026 | <strong>FRs cobertos:</strong> FR-28 a FR-32 | FR-33 âš ï¸</p>

            <h3>O que foi entregue</h3>
            <table>
                <thead><tr><th>#</th><th>Funcionalidade</th><th>FR</th><th>Status</th><th>DescriÃ§Ã£o</th></tr></thead>
                <tbody>
                    <tr><td>1</td><td>Saldo em anÃ¡lise</td><td>FR-28</td><td><span class="tag green">âœ…</span></td><td>PerÃ­odo de trava configurÃ¡vel</td></tr>
                    <tr><td>2</td><td>SolicitaÃ§Ã£o de saque</td><td>FR-29</td><td><span class="tag green">âœ…</span></td><td>FormulÃ¡rio com validaÃ§Ã£o PF/PJ</td></tr>
                    <tr><td>3</td><td>Upload de NF-e</td><td>FR-30</td><td><span class="tag green">âœ…</span></td><td>PJ envia nota fiscal</td></tr>
                    <tr><td>4</td><td>EmissÃ£o de RPA</td><td>FR-31</td><td><span class="tag green">âœ…</span></td><td>GeraÃ§Ã£o automÃ¡tica para PF</td></tr>
                    <tr><td>5</td><td>Workflow de aprovaÃ§Ã£o</td><td>FR-32</td><td><span class="tag green">âœ…</span></td><td>Admin aprova/rejeita saques</td></tr>
                    <tr><td>6</td><td>IntegraÃ§Ã£o de pagamento</td><td>FR-33</td><td><span class="tag yellow">âš ï¸</span></td><td>Aguardando definiÃ§Ã£o fintech</td></tr>
                </tbody>
            </table>

            <details open>
                <summary>ğŸ“‹ Fluxo de SolicitaÃ§Ã£o de Saque</summary>
                <div class="content">
                    <div class="diagram">
<pre>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FLUXO DE SOLICITAÃ‡ÃƒO DE SAQUE (Sprint 5)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1ï¸âƒ£ MEMBRO ACESSA "MEUS SAQUES"
   â”‚
   â”‚  URL: /dashboard/payouts
   â”‚
   â–¼
2ï¸âƒ£ SISTEMA EXIBE SALDO DISPONÃVEL
   â”‚
   â”‚  â”œâ”€â”€ Saldo total (commission_balances.total_earned)
   â”‚  â”œâ”€â”€ JÃ¡ sacado (commission_balances.total_withdrawn)
   â”‚  â”œâ”€â”€ Em anÃ¡lise (commission_balances.pending_amount)
   â”‚  â””â”€â”€ DisponÃ­vel (available_balance)
   â”‚
   â–¼
3ï¸âƒ£ MEMBRO PREENCHE FORMULÃRIO
   â”‚
   â”‚  â”œâ”€â”€ Valor do saque
   â”‚  â”œâ”€â”€ Tipo de pessoa (PF ou PJ)
   â”‚  â”œâ”€â”€ CPF ou CNPJ
   â”‚  â””â”€â”€ Dados bancÃ¡rios (banco, agÃªncia, conta, PIX)
   â”‚
   â–¼
4ï¸âƒ£ SISTEMA VALIDA REQUISITOS
   â”‚
   â”‚  â”œâ”€â”€ Saldo disponÃ­vel >= valor solicitado?
   â”‚  â”œâ”€â”€ Valor >= mÃ­nimo (R$100)?
   â”‚  â”œâ”€â”€ Se PF: limite mensal nÃ£o excedido (R$1.000)?
   â”‚  â””â”€â”€ Dados bancÃ¡rios vÃ¡lidos?
   â”‚
   â–¼
5ï¸âƒ£ SISTEMA CRIA SOLICITAÃ‡ÃƒO
   â”‚
   â”‚  â”œâ”€â”€ Cria registro em payout_requests
   â”‚  â”‚   â”œâ”€â”€ status: 'pending' (PF) ou 'awaiting_document' (PJ)
   â”‚  â”‚   â””â”€â”€ Dados bancÃ¡rios criptografados
   â”‚  â”œâ”€â”€ Atualiza commission_balances.pending_amount
   â”‚  â””â”€â”€ Cria entrada em payout_history (auditoria)
   â”‚
   â–¼
6ï¸âƒ£ FLUXO PF vs PJ
   â”‚
   â”‚  SE PF:
   â”‚  â”œâ”€â”€ Sistema gera RPA automaticamente
   â”‚  â””â”€â”€ Status = 'pending' (aguarda aprovaÃ§Ã£o admin)
   â”‚
   â”‚  SE PJ:
   â”‚  â”œâ”€â”€ Status = 'awaiting_document'
   â”‚  â””â”€â”€ Membro deve enviar NF-e
   â”‚
   â””â”€â”€ FIM DO FLUXO</pre>
                    </div>
                </div>
            </details>

            <details>
                <summary>ğŸ“„ Fluxo de Upload NF-e (PJ)</summary>
                <div class="content">
                    <div class="diagram">
<pre>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FLUXO DE UPLOAD NF-e (Sprint 5)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1ï¸âƒ£ MEMBRO PJ COM SAQUE PENDENTE
   â”‚
   â”‚  Status da solicitaÃ§Ã£o: 'awaiting_document'
   â”‚
   â–¼
2ï¸âƒ£ MEMBRO FAZ UPLOAD DA NF-e
   â”‚
   â”‚  POST /api/members/me/payouts/[id]/documents
   â”‚  â”œâ”€â”€ Arquivo: PDF ou XML da NF-e
   â”‚  â”œâ”€â”€ NÃºmero da nota
   â”‚  â”œâ”€â”€ Data de emissÃ£o
   â”‚  â””â”€â”€ Valor da nota
   â”‚
   â–¼
3ï¸âƒ£ SISTEMA ARMAZENA DOCUMENTO
   â”‚
   â”‚  â”œâ”€â”€ Upload para Supabase Storage (bucket: payout-documents)
   â”‚  â”œâ”€â”€ Cria registro em payout_documents
   â”‚  â””â”€â”€ Atualiza status da solicitaÃ§Ã£o para 'under_review'
   â”‚
   â–¼
4ï¸âƒ£ ADMIN VALIDA NF-e
   â”‚
   â”‚  â”œâ”€â”€ Verifica se valor da NF-e = valor do saque
   â”‚  â”œâ”€â”€ Verifica CNPJ emissor = CNPJ do membro
   â”‚  â””â”€â”€ Aprova ou rejeita documento
   â”‚
   â””â”€â”€ FIM DO FLUXO</pre>
                    </div>
                </div>
            </details>

            <details>
                <summary>âœ… Fluxo de AprovaÃ§Ã£o (Admin)</summary>
                <div class="content">
                    <div class="diagram">
<pre>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FLUXO DE APROVAÃ‡ÃƒO ADMIN (Sprint 5)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1ï¸âƒ£ ADMIN ACESSA "GESTÃƒO DE SAQUES"
   â”‚
   â”‚  URL: /admin/payouts
   â”‚
   â–¼
2ï¸âƒ£ LISTA DE SOLICITAÃ‡Ã•ES PENDENTES
   â”‚
   â”‚  Filtros disponÃ­veis:
   â”‚  â”œâ”€â”€ Por status (pending, under_review, approved, rejected)
   â”‚  â”œâ”€â”€ Por tipo (PF/PJ)
   â”‚  â””â”€â”€ Por membro
   â”‚
   â–¼
3ï¸âƒ£ ADMIN ANALISA SOLICITAÃ‡ÃƒO
   â”‚
   â”‚  GET /api/admin/payouts/[id]
   â”‚  â”œâ”€â”€ Dados do membro
   â”‚  â”œâ”€â”€ HistÃ³rico de saques
   â”‚  â”œâ”€â”€ Documentos anexados (NF-e, RPA)
   â”‚  â””â”€â”€ Timeline de status
   â”‚
   â–¼
4ï¸âƒ£ ADMIN APROVA OU REJEITA
   â”‚
   â”‚  PATCH /api/admin/payouts
   â”‚  â”‚
   â”‚  â”‚  SE APROVAR:
   â”‚  â”‚  â”œâ”€â”€ Status = 'approved'
   â”‚  â”‚  â”œâ”€â”€ Atualiza commission_balances.total_withdrawn
   â”‚  â”‚  â”œâ”€â”€ Zera pending_amount
   â”‚  â”‚  â””â”€â”€ Registra em payout_history
   â”‚  â”‚
   â”‚  â”‚  SE REJEITAR:
   â”‚  â”‚  â”œâ”€â”€ Status = 'rejected'
   â”‚  â”‚  â”œâ”€â”€ Motivo obrigatÃ³rio
   â”‚  â”‚  â””â”€â”€ Devolve valor para available_balance
   â”‚
   â–¼
5ï¸âƒ£ PAGAMENTO (via Asaas)
   â”‚
   â”‚  â”œâ”€â”€ TransferÃªncia automÃ¡tica PIX/TED
   â”‚  â”œâ”€â”€ Atualiza status para 'paid'
   â”‚  â””â”€â”€ Registra comprovante
   â”‚
   â””â”€â”€ FIM DO FLUXO</pre>
                    </div>
                </div>
            </details>

            <h3>Regras de Saque</h3>
            <div class="callout blue">
                <span class="callout-icon">ğŸ’°</span>
                <div class="callout-content">
                    <strong>PESSOA FÃSICA (PF):</strong> Limite R$1.000/mÃªs, RPA automÃ¡tico<br>
                    <strong>PESSOA JURÃDICA (PJ):</strong> Sem limite, NF-e obrigatÃ³ria<br>
                    <strong>GERAL:</strong> MÃ­nimo R$100, Net-15 (disponÃ­vel 15 dias apÃ³s virada do mÃªs)<br>
                    <strong>PAGAMENTO:</strong> via Asaas (PIX/TED)
                </div>
            </div>
        </section>

        <hr>

        <!-- SPRINT 6 -->
        <section id="sprint6">
            <h1>ğŸ† Sprint 6 â€” Admin AvanÃ§ado âœ…</h1>
            <p><strong>Data de conclusÃ£o:</strong> 20/01/2026 | <strong>FRs cobertos:</strong> FR-12, FR-34 a FR-38</p>

            <h3>O que foi entregue</h3>
            <table>
                <thead><tr><th>#</th><th>Funcionalidade</th><th>FR</th><th>Status</th><th>DescriÃ§Ã£o</th></tr></thead>
                <tbody>
                    <tr><td>1</td><td>Regra de 6 meses inativo</td><td>FR-12</td><td><span class="tag green">âœ…</span></td><td>CompressÃ£o automÃ¡tica de rede</td></tr>
                    <tr><td>2</td><td>Dashboard global</td><td>FR-35</td><td><span class="tag green">âœ…</span></td><td>KPIs completos via API</td></tr>
                    <tr><td>3</td><td>Filtros por comissÃ£o</td><td>FR-36</td><td><span class="tag green">âœ…</span></td><td>Filtro por tipo na API</td></tr>
                    <tr><td>4</td><td>GestÃ£o de membro</td><td>FR-37</td><td><span class="tag green">âœ…</span></td><td>Editar, ajustar, bloquear</td></tr>
                    <tr><td>5</td><td>GestÃ£o de tags</td><td>FR-38</td><td><span class="tag green">âœ…</span></td><td>CRUD + sync Shopify</td></tr>
                </tbody>
            </table>

            <details>
                <summary>ğŸ—œï¸ CompressÃ£o de Rede (6 Meses Inativo)</summary>
                <div class="content">
                    <div class="diagram">
<pre>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    COMPRESSÃƒO DE REDE (6 MESES INATIVO)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ANTES DA COMPRESSÃƒO:

    [Sponsor A]
         â”‚
    [Membro X] â† 6 meses sem atingir 200 CV
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚         â”‚
[Indicado 1] [Indicado 2]

DEPOIS DA COMPRESSÃƒO:

    [Sponsor A]
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚         â”‚
[Indicado 1] [Indicado 2]

[Membro X] â†’ status = 'removed', sponsor_id = null</pre>
                    </div>
                    <h4>Como funciona:</h4>
                    <ol class="numbered">
                        <li>Cron job executa no dia 1 de cada mÃªs Ã s 04:00 UTC</li>
                        <li>Identifica membros com 6+ meses consecutivos sem 200 CV</li>
                        <li>Move indicados para o sponsor do membro removido</li>
                        <li>Marca membro como status = 'removed'</li>
                        <li>Registra em auditoria (member_level_history)</li>
                    </ol>
                </div>
            </details>
        </section>

        <hr>

        <!-- SPRINT 7 -->
        <section id="sprint7">
            <h1>ğŸ Sprint 7 â€” Creatina + DecisÃµes Fev/2026 âœ…</h1>
            <p><strong>Data de conclusÃ£o:</strong> 11/02/2026 + SeguranÃ§a 18/02/2026 | <strong>Status:</strong> CONCLUÃDO (100%)</p>

            <div class="callout green">
                <span class="callout-icon">âœ…</span>
                <div class="callout-content">
                    <strong>6 DecisÃµes resolvidas e implementadas + SeguranÃ§a Anti-Fraude</strong>
                    <p>TBD-001, TBD-003, TBD-006, TBD-007, TBD-014, TBD-019</p>
                </div>
            </div>

            <h3>O que foi entregue</h3>
            <table>
                <thead><tr><th>#</th><th>Funcionalidade</th><th>TBD/FR</th><th>Status</th><th>DescriÃ§Ã£o</th></tr></thead>
                <tbody>
                    <tr><td>1</td><td>House Account</td><td>TBD-001</td><td><span class="tag green">âœ…</span></td><td>Cadastro sem link â†’ sponsor = empresa</td></tr>
                    <tr><td>2</td><td>Tag de nÃ­vel</td><td>TBD-003</td><td><span class="tag green">âœ…</span></td><td>Tag nivel:&lt;nivel&gt; no Shopify</td></tr>
                    <tr><td>3</td><td>ref_code sequencial</td><td>TBD-006</td><td><span class="tag green">âœ…</span></td><td>Formato BH00001 + customizaÃ§Ã£o admin</td></tr>
                    <tr><td>4</td><td>Landing page</td><td>TBD-007</td><td><span class="tag green">âœ…</span></td><td>Redirect para /login</td></tr>
                    <tr><td>5</td><td>CV sem fallback</td><td>TBD-014</td><td><span class="tag green">âœ…</span></td><td>CV=0 se metafield ausente</td></tr>
                    <tr><td>6</td><td>Cupom creatina</td><td>TBD-019</td><td><span class="tag green">âœ…</span></td><td>Cupom individual mensal via Shopify API</td></tr>
                    <tr><td>7</td><td>SeguranÃ§a anti-fraude</td><td>-</td><td><span class="tag green">âœ…</span></td><td>7 camadas de proteÃ§Ã£o no cupom</td></tr>
                </tbody>
            </table>

            <h2>TBD-019 â€” Cupom Individual Mensal de Creatina</h2>
            <p><strong>Regra:</strong> Membro Ativo (CV >= 200) recebe cupom exclusivo para 1 creatina grÃ¡tis/mÃªs.</p>
            <p><strong>Formato do cupom:</strong> <code>CREATINA-&lt;NOME&gt;-&lt;HASH&gt;-&lt;MÃŠSANO&gt;</code></p>
            <p>Exemplo: <code>CREATINA-MARIA-X7K9-FEV2026</code> â€” O hash aleatÃ³rio (X7K9) torna o cÃ³digo Ãºnico e nÃ£o adivinhÃ¡vel</p>

            <details open>
                <summary>ğŸ“‹ Fluxo da Creatina GrÃ¡tis</summary>
                <div class="content">
                    <div class="diagram">
<pre>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FLUXO DA CREATINA GRÃTIS (Sprint 7)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1ï¸âƒ£ SISTEMA GERA CUPONS (dia 2 de cada mÃªs, automÃ¡tico)
   â”‚
   â”‚  Cron job: /api/cron/generate-creatine-coupons
   â”‚  Para cada membro ativo:
   â”‚  â”œâ”€â”€ Cria Price Rule na Shopify (100% OFF, 1 uso)
   â”‚  â”œâ”€â”€ Restringe ao customer_id do membro (seguranÃ§a)
   â”‚  â””â”€â”€ Gera Discount Code: CREATINA-MARIA-X7K9-FEV2026
   â”‚
   â–¼
2ï¸âƒ£ MEMBRO ACESSA DASHBOARD
   â”‚
   â”‚  Card "Creatina GrÃ¡tis do MÃªs"
   â”‚  Mostra: "Seu cupom estÃ¡ pronto!"
   â”‚  Exibe cÃ³digo: CREATINA-MARIA-X7K9-FEV2026
   â”‚  BotÃ£o de copiar ğŸ“‹
   â”‚
   â–¼
3ï¸âƒ£ MEMBRO USA NA LOJA
   â”‚
   â”‚  Adiciona creatina ao carrinho
   â”‚  No checkout, cola o cupom
   â”‚  âš ï¸ Se outra pessoa tentar usar â†’ Shopify rejeita (restrito ao dono)
   â”‚  Desconto de 100% aplicado automaticamente
   â”‚
   â–¼
4ï¸âƒ£ WEBHOOK DETECTA USO + VALIDA SEGURANÃ‡A
   â”‚
   â”‚  Webhook orders/paid detecta cupom CREATINA-*
   â”‚  âœ… Se dono correto â†’ Atualiza status = 'claimed'
   â”‚  âš ï¸ Se fraude â†’ Registra em fraud_details
   â”‚
   â–¼
5ï¸âƒ£ DASHBOARD ATUALIZA
   â”‚
   â”‚  Card mostra: "JÃ¡ utilizado este mÃªs âœ…"
   â”‚  PrÃ³ximo cupom: mÃªs seguinte
   â”‚
   â””â”€â”€ FIM DO FLUXO</pre>
                    </div>
                </div>
            </details>

            <h3>Estados do Card no Dashboard</h3>
            <table>
                <thead><tr><th>Estado</th><th>Cor</th><th>DescriÃ§Ã£o</th></tr></thead>
                <tbody>
                    <tr><td>Cupom pronto</td><td><span class="tag green">ğŸŸ¢ Verde</span></td><td>Exibe cÃ³digo + botÃ£o copiar</td></tr>
                    <tr><td>JÃ¡ utilizado</td><td><span class="tag yellow">ğŸŸ¡ Amarelo</span></td><td>Membro usou este mÃªs</td></tr>
                    <tr><td>IndisponÃ­vel</td><td><span class="tag gray">âšª Cinza</span></td><td>Membro nÃ£o atingiu 200 CV</td></tr>
                    <tr><td>Gerando...</td><td><span class="tag blue">â³ Azul</span></td><td>Cupom sendo gerado</td></tr>
                </tbody>
            </table>

            <h2>ğŸ”’ SeguranÃ§a Anti-Fraude do Cupom (18/02/2026)</h2>
            
            <div class="security-box">
                <div class="security-item">
                    <span class="security-icon">ğŸ”’</span>
                    <div><strong>CAMADA 1: CÃ³digo NÃ£o AdivinhÃ¡vel</strong><br>Hash aleatÃ³rio de 4 caracteres (ex: X7K9). ImpossÃ­vel "chutar" o cÃ³digo de outro membro.</div>
                </div>
                <div class="security-item">
                    <span class="security-icon">ğŸ”’</span>
                    <div><strong>CAMADA 2: RestriÃ§Ã£o por Customer (Shopify)</strong><br>Cupom vinculado ao shopify_customer_id do membro. Shopify rejeita se outra pessoa tentar usar.</div>
                </div>
                <div class="security-item">
                    <span class="security-icon">ğŸ”’</span>
                    <div><strong>CAMADA 3: Limite de 1 Uso Global</strong><br>usage_limit: 1 â†’ Uma vez usado, cupom invÃ¡lido. once_per_customer: true â†’ Extra seguranÃ§a.</div>
                </div>
                <div class="security-item">
                    <span class="security-icon">ğŸ”’</span>
                    <div><strong>CAMADA 4: Validade Temporal</strong><br>Cupom expira no Ãºltimo dia do mÃªs. NÃ£o pode ser guardado para usar depois.</div>
                </div>
                <div class="security-item">
                    <span class="security-icon">ğŸ”’</span>
                    <div><strong>CAMADA 5: Unicidade no Banco</strong><br>UNIQUE INDEX em coupon_code. ImpossÃ­vel gerar cÃ³digo duplicado.</div>
                </div>
                <div class="security-item">
                    <span class="security-icon">ğŸ”’</span>
                    <div><strong>CAMADA 6: ValidaÃ§Ã£o no Webhook</strong><br>Webhook verifica se quem usou Ã© o dono. Fraude detectada â†’ Registra em fraud_details.</div>
                </div>
                <div class="security-item">
                    <span class="security-icon">ğŸ”’</span>
                    <div><strong>CAMADA 7: Auditoria Admin</strong><br>View v_creatine_fraud_attempts. Admin pode ver todas as tentativas suspeitas.</div>
                </div>
            </div>

            <h3>O que acontece em cada cenÃ¡rio</h3>
            <table>
                <thead><tr><th>CenÃ¡rio</th><th>Resultado</th></tr></thead>
                <tbody>
                    <tr><td>Membro usa seu prÃ³prio cupom</td><td><span class="tag green">âœ… Funciona normalmente</span></td></tr>
                    <tr><td>AlguÃ©m tenta usar cupom de outro</td><td><span class="tag red">âŒ Shopify rejeita (customer_selection)</span></td></tr>
                    <tr><td>AlguÃ©m "chuta" um cÃ³digo</td><td><span class="tag red">âŒ Hash torna impossÃ­vel adivinhar</span></td></tr>
                    <tr><td>Membro tenta usar 2x no mÃªs</td><td><span class="tag red">âŒ usage_limit: 1 jÃ¡ foi usado</span></td></tr>
                    <tr><td>Membro guarda para mÃªs seguinte</td><td><span class="tag red">âŒ ends_at expira fim do mÃªs</span></td></tr>
                    <tr><td>Fraude passa (edge case)</td><td><span class="tag yellow">âš ï¸ Webhook registra fraud_details</span></td></tr>
                </tbody>
            </table>

            <h3>APIs e Banco de Dados (Sprint 7)</h3>
            <table>
                <thead><tr><th>Item</th><th>DescriÃ§Ã£o</th></tr></thead>
                <tbody>
                    <tr><td><code>GET /api/members/me/free-creatine</code></td><td>Elegibilidade + gera cupom</td></tr>
                    <tr><td><code>PATCH /api/admin/members/[id]</code></td><td>Customizar ref_code</td></tr>
                    <tr><td><code>GET /api/cron/generate-creatine-coupons</code></td><td>Cron mensal (dia 2, 05:00 UTC)</td></tr>
                    <tr><td><code>free_creatine_claims.coupon_code</code></td><td>CÃ³digo do cupom gerado</td></tr>
                    <tr><td><code>free_creatine_claims.fraud_details</code></td><td>JSON com detalhes de fraude</td></tr>
                    <tr><td><code>v_creatine_fraud_attempts</code></td><td>View para auditoria de fraudes</td></tr>
                    <tr><td>UNIQUE(coupon_code)</td><td>Garante cÃ³digo Ãºnico (seguranÃ§a)</td></tr>
                </tbody>
            </table>
        </section>

        <hr>

        <!-- COMO TESTAR -->
        <section id="testar">
            <h1>ğŸ§ª Como Testar</h1>

            <h3>URLs de Acesso</h3>
            <table>
                <thead><tr><th>PÃ¡gina</th><th>URL</th></tr></thead>
                <tbody>
                    <tr><td>Home</td><td><a href="https://rlp-biohelp.vercel.app/">https://rlp-biohelp.vercel.app/</a></td></tr>
                    <tr><td>Login</td><td><a href="https://rlp-biohelp.vercel.app/login">https://rlp-biohelp.vercel.app/login</a></td></tr>
                    <tr><td>Cadastro</td><td><a href="https://rlp-biohelp.vercel.app/join?ref=SPONSOR01">https://rlp-biohelp.vercel.app/join?ref=SPONSOR01</a></td></tr>
                    <tr><td>Dashboard</td><td><a href="https://rlp-biohelp.vercel.app/dashboard">https://rlp-biohelp.vercel.app/dashboard</a></td></tr>
                    <tr><td>Minha Rede</td><td><a href="https://rlp-biohelp.vercel.app/dashboard/network">https://rlp-biohelp.vercel.app/dashboard/network</a></td></tr>
                    <tr><td>ComissÃµes</td><td><a href="https://rlp-biohelp.vercel.app/dashboard/commissions">https://rlp-biohelp.vercel.app/dashboard/commissions</a></td></tr>
                    <tr><td>Saques</td><td><a href="https://rlp-biohelp.vercel.app/dashboard/payouts">https://rlp-biohelp.vercel.app/dashboard/payouts</a></td></tr>
                    <tr><td>Admin</td><td><a href="https://rlp-biohelp.vercel.app/admin">https://rlp-biohelp.vercel.app/admin</a></td></tr>
                </tbody>
            </table>

            <h3>Loja Shopify de Teste</h3>
            <table>
                <thead><tr><th>Item</th><th>Valor</th></tr></thead>
                <tbody>
                    <tr><td>URL da Loja</td><td><a href="https://biohelp-dev.myshopify.com/">https://biohelp-dev.myshopify.com/</a></td></tr>
                    <tr><td>Senha de Acesso</td><td><code>nowcli</code></td></tr>
                    <tr><td>Produto de Teste</td><td>Creatina Teste LRP ($150.00)</td></tr>
                </tbody>
            </table>

            <h4>Pagamentos de Teste (Gateway FictÃ­cio)</h4>
            <table>
                <thead><tr><th>Campo</th><th>Valor para APROVAR</th><th>Valor para RECUSAR</th></tr></thead>
                <tbody>
                    <tr><td>NÃºmero do cartÃ£o</td><td><code>1</code></td><td><code>2</code></td></tr>
                    <tr><td>Data de validade</td><td>Qualquer data futura (ex: 12/28)</td><td>Qualquer data futura</td></tr>
                    <tr><td>CVV</td><td>Qualquer 3 dÃ­gitos (ex: 123)</td><td>Qualquer 3 dÃ­gitos</td></tr>
                    <tr><td>Nome no cartÃ£o</td><td>Qualquer nome</td><td>Qualquer nome</td></tr>
                </tbody>
            </table>

            <h3>Logins de Teste</h3>
            <table>
                <thead><tr><th>Portal</th><th>Email</th><th>Senha</th></tr></thead>
                <tbody>
                    <tr><td>Admin</td><td><code>admin@biohelp.test</code></td><td><code>123456</code></td></tr>
                    <tr><td>Parceira</td><td><code>sponsor@biohelp.test</code></td><td><code>sponsor123</code></td></tr>
                </tbody>
            </table>

            <h3>Roteiro de Teste RÃ¡pido</h3>
            <details open>
                <summary>Teste 0: Compra de Teste na Shopify (Fluxo Completo)</summary>
                <div class="content">
                    <p><strong>PrÃ©-requisitos:</strong> Ter um membro cadastrado no LRP e conhecer o email usado.</p>
                    <ol class="numbered">
                        <li>Acesse a loja: <a href="https://biohelp-dev.myshopify.com/">https://biohelp-dev.myshopify.com/</a> e digite a senha: <code>nowcli</code></li>
                        <li>Adicione "Creatina Teste LRP" ao carrinho e clique em "Check out"</li>
                        <li>Preencha o <strong>email</strong> (MESMO email do cadastro no LRP)</li>
                        <li>Pague com cartÃ£o de teste: NÃºmero <code>1</code>, Data <code>12/28</code>, CVV <code>123</code></li>
                        <li>Clique em "Pay now" e aguarde 1-2 minutos</li>
                        <li>Acesse <a href="https://rlp-biohelp.vercel.app/dashboard">https://rlp-biohelp.vercel.app/dashboard</a> e verifique se o CV foi atualizado</li>
                    </ol>
                    <div class="callout blue">
                        <span class="callout-icon">ğŸ’¡</span>
                        <div class="callout-content">
                            <strong>Importante:</strong> O sistema identifica o membro pelo EMAIL do pedido. Use o mesmo email do cadastro no LRP.
                        </div>
                    </div>
                </div>
            </details>
        </section>

        <hr>

        <!-- TESTES REALIZADOS -->
        <section id="testes-realizados">
            <h1>ğŸ§ª Testes Realizados (04/02/2026)</h1>

            <div class="callout green">
                <span class="callout-icon">âœ…</span>
                <div class="callout-content">
                    <strong>Teste de IntegraÃ§Ã£o Completa - APROVADO</strong>
                    <p><strong>Data:</strong> 04/02/2026 | <strong>Ambiente:</strong> ProduÃ§Ã£o (Vercel) + Loja de Desenvolvimento (Shopify)</p>
                </div>
            </div>

            <h3>CenÃ¡rio Testado: Autoconsumo</h3>
            <table>
                <thead><tr><th>Etapa</th><th>AÃ§Ã£o</th><th>Resultado</th><th>Status</th></tr></thead>
                <tbody>
                    <tr><td>1</td><td>Cadastro no LRP</td><td>Membro "eduardo" criado com cÃ³digo J6QTY7hy</td><td><span class="tag green">âœ…</span></td></tr>
                    <tr><td>2</td><td>Acesso Ã  loja Shopify</td><td>Login com senha nowcli</td><td><span class="tag green">âœ…</span></td></tr>
                    <tr><td>3</td><td>Compra #1002</td><td>Creatina Teste LRP ($150.00)</td><td><span class="tag green">âœ…</span></td></tr>
                    <tr><td>4</td><td>Webhook processado</td><td>CV creditado automaticamente</td><td><span class="tag green">âœ…</span></td></tr>
                    <tr><td>5</td><td>Compra #1003</td><td>2x Creatina Teste LRP ($300.00)</td><td><span class="tag green">âœ…</span></td></tr>
                    <tr><td>6</td><td>Dashboard atualizado</td><td>450 CV, Status: Ativa, 100% da meta</td><td><span class="tag green">âœ…</span></td></tr>
                </tbody>
            </table>

            <div class="columns">
                <div class="column">
                    <h4>Dashboard do Membro</h4>
                    <ul class="bullet">
                        <li>CV do MÃªs: <strong>450 CV</strong></li>
                        <li>Meta: <strong>200 CV</strong> (100% atingida)</li>
                        <li>Status: <strong>Ativa</strong></li>
                        <li>NÃ­vel: <strong>Parceira</strong></li>
                        <li>CÃ³digo: <strong>J6QTY7hy</strong></li>
                    </ul>
                </div>
                <div class="column">
                    <h4>Shopify Admin - Pedidos</h4>
                    <ul class="bullet">
                        <li>Pedido #1002: $150.00 - Pago - Processado</li>
                        <li>Pedido #1003: $300.00 - Pago - Processado</li>
                    </ul>
                </div>
            </div>
        </section>

        <hr>

        <!-- TIPOS DE COMPRA -->
        <section id="tipos-compra">
            <h1>ğŸ“Š Entendendo os Dois Tipos de Compra</h1>

            <div class="columns">
                <div class="column">
                    <h3>Tipo 1: Autoconsumo</h3>
                    <p><strong>Parceira compra para si mesma</strong></p>
                    <div class="diagram">
<pre>Parceira (vocÃª)
    â”‚
    â–¼
Compra na loja (usando SEU email)
    â”‚
    â–¼
CV Ã© creditado para VOCÃŠ
    â”‚
    â–¼
VocÃª atinge meta de 200 CV â†’ Status ATIVA

âš ï¸ VocÃª NÃƒO recebe comissÃ£o</pre>
                    </div>
                </div>
                <div class="column">
                    <h3>Tipo 2: IndicaÃ§Ã£o</h3>
                    <p><strong>Cliente compra pelo seu link</strong></p>
                    <div class="diagram">
<pre>1ï¸âƒ£ VocÃª compartilha seu link
    â”‚
    â–¼
2ï¸âƒ£ Cliente se cadastra
    â”‚
    â–¼
3ï¸âƒ£ Cliente compra (email DELE)
    â”‚
    â–¼
4ï¸âƒ£ CV vai para o CLIENTE
    â”‚
    â–¼
5ï¸âƒ£ VOCÃŠ recebe COMISSÃƒO:
   â€¢ Fast-Track 30% (dias 1-30)
   â€¢ Fast-Track 20% (dias 31-60)
   â€¢ PerpÃ©tua 5-15% (apÃ³s 60 dias)</pre>
                    </div>
                </div>
            </div>

            <h3>Resumo das DiferenÃ§as</h3>
            <table>
                <thead><tr><th>Aspecto</th><th>Autoconsumo</th><th>IndicaÃ§Ã£o</th></tr></thead>
                <tbody>
                    <tr><td>Quem compra</td><td>VocÃª (parceira)</td><td>Seu cliente indicado</td></tr>
                    <tr><td>Email no checkout</td><td>Seu email</td><td>Email do cliente</td></tr>
                    <tr><td>CV vai para</td><td>VocÃª</td><td>Cliente</td></tr>
                    <tr><td>VocÃª recebe comissÃ£o?</td><td><span class="tag red">âŒ NÃ£o</span></td><td><span class="tag green">âœ… Sim</span></td></tr>
                    <tr><td>Ajuda sua meta?</td><td><span class="tag green">âœ… Sim</span></td><td><span class="tag red">âŒ NÃ£o</span></td></tr>
                </tbody>
            </table>
        </section>

        <hr>

        <!-- DECISÃ•ES TBD -->
        <section id="tbd">
            <h1>ğŸ“‹ DecisÃµes (TBD)</h1>

            <h3>Pendentes (1 restante)</h3>
            <table>
                <thead><tr><th>TBD</th><th>DescriÃ§Ã£o</th><th>Sprint</th><th>Impacto</th></tr></thead>
                <tbody>
                    <tr><td>TBD-004</td><td>URLs oficiais (staging/prod)</td><td>1</td><td>Redirects e webhooks</td></tr>
                </tbody>
            </table>

            <h3>Resolvidos âœ… (21 decisÃµes)</h3>
            <table>
                <thead><tr><th>TBD</th><th>DescriÃ§Ã£o</th><th>DecisÃ£o</th><th>Data</th></tr></thead>
                <tbody>
                    <tr><td>TBD-001</td><td>Cadastro sem link</td><td>House Account</td><td>11/02/2026</td></tr>
                    <tr><td>TBD-003</td><td>Tags/metacampos</td><td>Tags atuais + nivel:&lt;nivel&gt;</td><td>11/02/2026</td></tr>
                    <tr><td>TBD-006</td><td>Formato ref_code</td><td>Sequencial BH00001 + customizaÃ§Ã£o</td><td>11/02/2026</td></tr>
                    <tr><td>TBD-014</td><td>Metafield CV</td><td>custom.cv, CV=0 se ausente</td><td>11/02/2026</td></tr>
                    <tr><td>TBD-019</td><td>Creatina grÃ¡tis</td><td>Cupom Individual Mensal + SeguranÃ§a</td><td>18/02/2026</td></tr>
                    <tr><td>TBD-008</td><td>CÃ¡lculo de CV</td><td>Via metafield do produto</td><td>07/01/2026</td></tr>
                    <tr><td>TBD-009</td><td>Refund/cancel</td><td>Reverte CV completamente</td><td>07/01/2026</td></tr>
                    <tr><td>TBD-015</td><td>Limite de saque PF</td><td>R$1.000/mÃªs</td><td>19/01/2026</td></tr>
                    <tr><td>TBD-016</td><td>Valor mÃ­nimo para saque</td><td>R$100/saque</td><td>19/01/2026</td></tr>
                    <tr><td>TBD-018</td><td>IntegraÃ§Ã£o fintech</td><td>Asaas (PIX/TED)</td><td>19/01/2026</td></tr>
                    <tr><td>TBD-021</td><td>PerÃ­odo de trava</td><td>Net-15</td><td>19/01/2026</td></tr>
                    <tr><td>TBD-022</td><td>PerpÃ©tua diferenciada</td><td>Por tipo de N1</td><td>10/01/2026</td></tr>
                </tbody>
            </table>
        </section>

        <hr>

        <!-- CHECKLIST -->
        <section id="checklist">
            <h1>âœ… Checklist de Aceite</h1>

            <div class="columns">
                <div class="column">
                    <h4>Sprint 1 âœ…</h4>
                    <ul class="checklist">
                        <li>Cadastro com link vincula sponsor</li>
                        <li>Cadastro sem link â†’ House Account</li>
                        <li>ref_code sequencial BH00001</li>
                        <li>Customer Shopify criado/atualizado</li>
                        <li>Tags aplicadas (incluindo nivel:)</li>
                        <li>Dashboard mostra link de convite</li>
                        <li>RLS ativo</li>
                    </ul>
                </div>
                <div class="column">
                    <h4>Sprint 2 âœ…</h4>
                    <ul class="checklist">
                        <li>Webhooks idempotentes</li>
                        <li>CV via metafield custom.cv</li>
                        <li>Status muda para active/inactive</li>
                        <li>Job mensal fecha mÃªs</li>
                        <li>Admin pode ver/ajustar CV</li>
                        <li>Ledger auditÃ¡vel</li>
                    </ul>
                </div>
            </div>

            <div class="columns">
                <div class="column">
                    <h4>Sprint 3 âœ…</h4>
                    <ul class="checklist">
                        <li>API de rede funcionando</li>
                        <li>API de nÃ­vel funcionando</li>
                        <li>PÃ¡gina "Minha Rede" com Ã¡rvore visual</li>
                        <li>Progresso para prÃ³ximo nÃ­vel</li>
                        <li>Privacidade de telefone</li>
                    </ul>
                </div>
                <div class="column">
                    <h4>Sprint 4 âœ…</h4>
                    <ul class="checklist">
                        <li>Fast-Track 30%/20%</li>
                        <li>PerpÃ©tua diferenciada por tipo de N1</li>
                        <li>BÃ´nus 3 implementado</li>
                        <li>Leadership 3%/4%</li>
                        <li>Royalty implementado</li>
                        <li>Dashboard de comissÃµes</li>
                    </ul>
                </div>
            </div>

            <div class="columns">
                <div class="column">
                    <h4>Sprint 5 âœ…</h4>
                    <ul class="checklist">
                        <li>SolicitaÃ§Ã£o de saque (PF e PJ)</li>
                        <li>Upload de NF-e (PJ)</li>
                        <li>GeraÃ§Ã£o de RPA (PF)</li>
                        <li>Limite mensal PF (R$1.000)</li>
                        <li>Workflow de aprovaÃ§Ã£o admin</li>
                    </ul>
                </div>
                <div class="column">
                    <h4>Sprint 6 âœ…</h4>
                    <ul class="checklist">
                        <li>Regra de 6 meses inativo</li>
                        <li>Dashboard global (KPIs)</li>
                        <li>GestÃ£o completa de membro</li>
                        <li>GestÃ£o de tags + sync Shopify</li>
                    </ul>
                </div>
            </div>

            <div class="column" style="margin-top: 20px;">
                <h4>Sprint 7 âœ…</h4>
                <ul class="checklist">
                    <li>House Account implementado (TBD-001)</li>
                    <li>Tag de nÃ­vel nivel:&lt;nivel&gt; (TBD-003)</li>
                    <li>ref_code sequencial BH00001 (TBD-006)</li>
                    <li>CV=0 se metafield ausente (TBD-014)</li>
                    <li>Cupom individual mensal creatina (TBD-019)</li>
                    <li>Frontend exibe cupom no dashboard</li>
                    <li>Cron mensal gera cupons (dia 2/mÃªs)</li>
                    <li>Webhook detecta uso de cupom CREATINA-*</li>
                    <li>SeguranÃ§a anti-fraude com 7 camadas</li>
                    <li>View de auditoria para admin</li>
                </ul>
            </div>
        </section>

        <hr>

        <!-- STATUS ATUAL -->
        <section>
            <h1>ğŸ‰ Status Atual</h1>

            <div class="callout green">
                <span class="callout-icon">âœ…</span>
                <div class="callout-content">
                    <strong>Todos os Sprints (1-7) â€” CONCLUÃDOS!</strong>
                    <p><strong>Data de conclusÃ£o Sprint 7:</strong> 11/02/2026</p>
                    <p><strong>SeguranÃ§a anti-fraude:</strong> 18/02/2026</p>
                    <p><strong>Testes de integraÃ§Ã£o:</strong> âœ… APROVADOS (04/02/2026)</p>
                    <p><strong>Cobertura de FRs:</strong> 98% (37/38 implementados)</p>
                    <p><strong>TBDs resolvidos:</strong> 21/22 (1 pendente: TBD-004)</p>
                </div>
            </div>

            <h3>PrÃ³ximos Passos</h3>
            <ul class="bullet">
                <li>â³ IntegraÃ§Ã£o Asaas automÃ¡tica (aguardando credenciais)</li>
                <li>â³ Definir URLs oficiais staging/prod (TBD-004)</li>
                <li>â³ Remover senha da loja para produÃ§Ã£o</li>
                <li>â³ Testar fluxo completo de indicaÃ§Ã£o (comissÃµes em produÃ§Ã£o)</li>
            </ul>
        </section>

        <!-- Footer -->
        <footer class="page-footer">
            <p>Biohelp LRP â€” Status do Projeto</p>
            <p>Ãšltima atualizaÃ§Ã£o: 18/02/2026</p>
        </footer>
    </div>
</body>
</html>
